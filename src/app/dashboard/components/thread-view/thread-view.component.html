<div class="thread-container">
  <!-- Original Message -->
  <div class="original-message">
    <div class="message-item">
      <div class="message-avatar">
        <img [src]="originalMessage.userAvatar" [alt]="originalMessage.userName">
      </div>
      <div class="message-content">
        <div class="message-header">
          <div class="message-sender">{{ originalMessage.userName }}</div>
          <div class="message-time">{{ originalMessage.timestamp | date:'HH:mm' }} Uhr</div>
        </div>
        <div class="message-bubble">{{ originalMessage.content }}</div>
        
        <!-- Reaktions-Button fÃ¼r die ursprÃ¼ngliche Nachricht -->
        <div class="message-actions">
          <div class="action-buttons">
            <button class="action-button emoji-button" (click)="addReaction(originalMessage)">
              <span>ğŸ˜Š</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Replies Count -->
  <div class="replies-count">
    {{ replies.length }} Antworten
  </div>
  
  <!-- Replies -->
  <div class="replies-container">
    <div *ngFor="let reply of replies" class="message-item" [class.own-message]="reply.userId === currentUserId">
      <div class="message-avatar" *ngIf="reply.userId !== currentUserId">
        <img [src]="reply.userAvatar" [alt]="reply.userName">
      </div>
      
      <div class="message-content" [class.own-message-content]="reply.userId === currentUserId">
        <div class="message-header">
          <div class="message-sender">{{ reply.userName }}</div>
          <div class="message-time">{{ reply.timestamp | date:'HH:mm' }} Uhr</div>
        </div>
        <!-- <div class="message-bubble">{{ reply.content }}</div> -->
        
        <!-- Message Actions -->
        <div class="message-actions">
          <div class="reactions" *ngIf="reply.reactions?.length">
            <div
              *ngFor="let reaction of reply.reactions"
              class="reaction-badge"
            >
              {{ reaction.emoji }} {{ reaction.count }}
            </div>
          </div>
          <div class="action-buttons">
            <button class="action-button emoji-button" (click)="addReaction(reply)">
              <span>ğŸ˜Š</span>
            </button>
          </div>
        </div>
      </div>
      
      <div class="message-avatar" *ngIf="reply.userId === currentUserId">
        <img [src]="reply.userAvatar" [alt]="reply.userName">
      </div>
    </div>
  </div>
  
  <!-- Reply Input -->
  <div class="reply-input-container">
    <div class="reply-input-wrapper">
      <textarea 
        class="reply-input" 
        placeholder="Antworten..."
        [(ngModel)]="replyInput"
        (keydown.enter)="$event.preventDefault(); sendReply()"
      ></textarea>
      <div class="input-actions">
        <div class="input-tools">
          <button class="tool-button mention-button" (click)="insertMention()">
            <span>&#64;</span>
          </button>
          <button class="tool-button emoji-button" (click)="openEmojiPicker()">
            <span>ğŸ˜Š</span>
          </button>
        </div>
        <button class="send-button" [disabled]="!replyInput.trim()" (click)="sendReply()">
          <img src="assets/svg/send.svg" alt="Senden" class="send-icon">
        </button>
      </div>
    </div>
  </div>
  
  <!-- Emoji Picker -->
  <div *ngIf="showEmojiPicker" class="emoji-picker-container">
    <div class="custom-emoji-picker">
      <div class="emoji-picker-header">
        <div class="emoji-search">
          <input type="text" placeholder="Suchen" class="emoji-search-input">
          <button class="emoji-search-button">
            <span>ğŸ”</span>
          </button>
        </div>
        <div class="emoji-picker-close" (click)="openEmojiPicker()">
          <span>Ã—</span>
        </div>
      </div>
      
      <div class="emoji-picker-content">
        <div class="emoji-categories">
          <button class="emoji-category-btn active">ğŸ˜€</button>
          <button class="emoji-category-btn">ğŸ™‚</button>
          <button class="emoji-category-btn">ğŸš—</button>
          <button class="emoji-category-btn">ğŸ€</button>
          <button class="emoji-category-btn">ğŸ³ï¸</button>
          <button class="emoji-category-btn">ğŸ”£</button>
          <button class="emoji-category-btn">ğŸ</button>
        </div>
        
        <div class="emoji-list">
          <div class="emoji-section">
            <div class="emoji-section-title">KÃ¼rzlich verwendet</div>
            <div class="emoji-grid">
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ‘'})">ğŸ‘</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜€'})">ğŸ˜€</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜‰'})">ğŸ˜‰</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜'})">ğŸ˜</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜œ'})">ğŸ˜œ</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜‚'})">ğŸ˜‚</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ¤£'})">ğŸ¤£</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜±'})">ğŸ˜±</button>
            </div>
          </div>
          
          <div class="emoji-section">
            <div class="emoji-section-title">Smileys & Personen</div>
            <div class="emoji-grid">
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜€'})">ğŸ˜€</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜ƒ'})">ğŸ˜ƒ</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜„'})">ğŸ˜„</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜'})">ğŸ˜</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜†'})">ğŸ˜†</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜…'})">ğŸ˜…</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ¤£'})">ğŸ¤£</button>
              <button class="emoji-btn" (click)="addEmoji({emoji: 'ğŸ˜‚'})">ğŸ˜‚</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 